{
    email {$EMAIL_FOR_SSL}
    # To enable automatic HTTPS, comment out the line below and ensure your domain points to this server's IP.
    auto_https off # Set to off for IP-based testing. Remove for production domain.
}

:80 {
    # ─── Backend API ───
    handle /api/* {
        reverse_proxy backend:3000
    }

    # ─── Tracking WebSockets ───
    handle /ws/* {
        reverse_proxy backend:3000
    }

    # ─── Frontend (Catch-all) ───
    handle {
        reverse_proxy frontend:80
    }

    # Optional: Gzip compression
    encode gzip
}
